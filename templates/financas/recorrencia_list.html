{% extends 'base.html' %}
{% block title %}Recorrências{% endblock %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
  <h1 class="h4">Recorrências</h1>
  <a href="{% url 'financas:recorrencia_nova' %}" class="btn btn-primary">Nova recorrência</a>
</div>

<table class="table table-striped align-middle">
  <thead>
    <tr>
      <th>Título</th>
      <th>Tipo</th>
      <th>Categoria</th>
      <th class="text-end">Valor (R$)</th>
      <th>Vencimento</th>
      <th>Início</th>
      <th>Meses</th>
      <th>Ativa</th>
      <th class="text-center">Ações</th>
    </tr>
  </thead>
  <tbody>
    {% for r in itens %}
    <tr>
      <td>{{ r.titulo }}</td>
      <td>{% if r.tipo == 'E' %}<span class="badge bg-success">Entrada</span>{% else %}<span class="badge bg-danger">Saída</span>{% endif %}</td>
      <td>{{ r.get_categoria_display }}</td>
      <td class="text-end">{{ r.valor }}</td>
      <td>D{{ r.dia_vencimento }}</td>
      <td>{{ r.inicio|date:'m/Y' }}</td>
      <td>{% if r.meses %}{{ r.meses }}{% else %}∞{% endif %}</td>
      <td>{% if r.ativo %}<span class="badge bg-success">Sim</span>{% else %}<span class="badge bg-secondary">Não</span>{% endif %}</td>
      <td class="text-center">
        <a href="{% url 'financas:recorrencia_editar' r.pk %}" class="btn btn-sm btn-warning">Editar</a>
        <a href="{% url 'financas:recorrencia_toggle' r.pk %}" class="btn btn-sm btn-outline-secondary">
          {% if r.ativo %}Desativar{% else %}Ativar{% endif %}
        </a>
      </td>
    </tr>
    {% empty %}
    <tr><td colspan="9" class="text-center">Nenhuma recorrência.</td></tr>
    {% endfor %}
  </tbody>
</table>
{% endblock %}
